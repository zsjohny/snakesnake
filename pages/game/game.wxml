<view class="game-container">
  <!-- æ¸¸æˆçŠ¶æ€æ  -->
  <view class="game-status">
    <view class="status-item">
      <text class="status-label">åˆ†æ•°</text>
      <text class="status-value">{{score}}</text>
    </view>
    <view class="status-item">
      <text class="status-label">é•¿åº¦</text>
      <text class="status-value">{{snakeLength}}</text>
    </view>
    <view class="status-item">
      <text class="status-label">æ’å</text>
      <text class="status-value">{{rank}}</text>
    </view>
    <view class="status-item">
      <text class="status-label">åœ¨çº¿</text>
      <text class="status-value">{{onlinePlayers}}</text>
    </view>
  </view>

  <!-- æ¸¸æˆç”»å¸ƒ -->
  <view class="game-canvas-container">
    <canvas 
      canvas-id="gameCanvas" 
      class="game-canvas"
      style="width: {{canvasWidth}}px; height: {{canvasHeight}}px;"
      bindtouchstart="onTouchStart"
      bindtouchmove="onTouchMove"
      bindtouchend="onTouchEnd">
    </canvas>
    
    <!-- æ¸¸æˆæš‚åœé®ç½© -->
    <view class="game-overlay" wx:if="{{isPaused}}">
      <view class="overlay-content">
        <text class="overlay-title">æ¸¸æˆæš‚åœ</text>
        <button class="btn btn-primary" bindtap="resumeGame">ç»§ç»­æ¸¸æˆ</button>
        <button class="btn btn-danger" bindtap="quitGame">é€€å‡ºæ¸¸æˆ</button>
      </view>
    </view>

    <!-- æ¸¸æˆç»“æŸé®ç½© -->
    <view class="game-overlay" wx:if="{{isGameOver}}">
      <view class="overlay-content">
        <text class="overlay-title">æ¸¸æˆç»“æŸ</text>
        <text class="overlay-score">æœ€ç»ˆå¾—åˆ†: {{score}}</text>
        <text class="overlay-rank">æœ€ç»ˆæ’å: ç¬¬{{rank}}å</text>
        <button class="btn btn-primary" bindtap="restartGame">é‡æ–°å¼€å§‹</button>
        <button class="btn btn-success" bindtap="backToHome">è¿”å›é¦–é¡µ</button>
      </view>
    </view>
  </view>

  <!-- æ¸¸æˆæ§åˆ¶é¢æ¿ -->
  <view class="game-controls">
    <!-- æ–¹å‘æ§åˆ¶ -->
    <view class="direction-controls">
      <view class="direction-row">
        <view class="direction-btn direction-up" bindtap="moveUp">
          <text class="direction-icon">â†‘</text>
        </view>
      </view>
      <view class="direction-row">
        <view class="direction-btn direction-left" bindtap="moveLeft">
          <text class="direction-icon">â†</text>
        </view>
        <view class="direction-btn direction-center" bindtap="pauseGame">
          <text class="direction-icon">â¸</text>
        </view>
        <view class="direction-btn direction-right" bindtap="moveRight">
          <text class="direction-icon">â†’</text>
        </view>
      </view>
      <view class="direction-row">
        <view class="direction-btn direction-down" bindtap="moveDown">
          <text class="direction-icon">â†“</text>
        </view>
      </view>
    </view>

    <!-- åŠŸèƒ½æŒ‰é’® -->
    <view class="function-controls">
      <button class="btn btn-warning btn-small" bindtap="useSpeedBoost">
        <text class="btn-text">åŠ é€Ÿ</text>
      </button>
      <button class="btn btn-success btn-small" bindtap="useShield">
        <text class="btn-text">æŠ¤ç›¾</text>
      </button>
      <button class="btn btn-danger btn-small" bindtap="useTeleport">
        <text class="btn-text">ä¼ é€</text>
      </button>
    </view>
  </view>

  <!-- å®æ—¶æ’è¡Œæ¦œ -->
  <view class="live-ranking" wx:if="{{showRanking}}">
    <view class="ranking-header">
      <text class="ranking-title">å®æ—¶æ’è¡Œæ¦œ</text>
      <text class="ranking-close" bindtap="toggleRanking">Ã—</text>
    </view>
    <view class="ranking-list">
      <view class="ranking-item" wx:for="{{rankingList}}" wx:key="id">
        <view class="ranking-info">
          <text class="ranking-number {{item.rank <= 3 ? 'top-' + item.rank : ''}}">{{item.rank}}</text>
          <text class="ranking-name">{{item.name}}</text>
        </view>
        <text class="ranking-score">{{item.score}}</text>
      </view>
    </view>
  </view>

  <!-- æ¸¸æˆä¿¡æ¯é¢æ¿ -->
  <view class="game-info-panel">
    <view class="info-item">
      <text class="info-label">ç¤¼åŒ…æ•°é‡:</text>
      <text class="info-value">{{giftCount}}</text>
    </view>
    <view class="info-item">
      <text class="info-label">é»‘æ´æ•°é‡:</text>
      <text class="info-value">{{blackHoleCount}}</text>
    </view>
    <view class="info-item">
      <text class="info-label">æ¸¸æˆæ—¶é—´:</text>
      <text class="info-value">{{gameTime}}</text>
    </view>
  </view>

  <!-- æµ®åŠ¨æŒ‰é’® -->
  <view class="float-buttons">
    <view class="float-btn ranking-btn" bindtap="toggleRanking">
      <text class="float-btn-icon">ğŸ†</text>
    </view>
    <view class="float-btn chat-btn" bindtap="openChat">
      <text class="float-btn-icon">ğŸ’¬</text>
    </view>
  </view>
</view> 